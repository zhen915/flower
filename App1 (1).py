import streamlit as st
import asyncio
try:
    asyncio.get_running_loop()
except RuntimeError:
    asyncio.set_event_loop(asyncio.new_event_loop())
import torch
import numpy as np
from PIL import Image
from ultralytics import YOLO
import cv2
model = YOLO('best (1).pt')

plant_info = {
    "Adenium obesum": {
        "中文名稱": "沙漠玫瑰(別名:富貴花)",
        "屬性": "夾竹桃科沙漠玫瑰屬",
        "花的顏色": "紅色、白色、粉紅色",
        "花語": "忠貞不渝",
        "生長季節": "花期春季、夏季、秋季",
        "分佈": "外來種：原生於非洲東部到西亞的乾旱地中；台灣常作為觀賞植物栽培。",
        "毒性警告": "全株均有毒。家畜或幼兒誤食莖葉或乳汁，會引起心跳加速、心律不整等心臟疾病。",
        "食用安全性": "不可食用。",
        "藥用價值": "傷口敷料、治療潰瘍以及作為心臟強壯劑和治療性病的補助治療。",
        "環保資訊": "有助於節約水資源，通過吸收污染物並釋放氧氣來改善室內空氣質量。",
    },
    "Bidens_alba": {
        "中文名稱": "大花咸豐草(別名：鬼針草)",
        "屬性": "菊科鬼針草屬",
        "花的顏色": "白色, 黃色",
        "花語": "安然自在的表達自我",
        "生長季節": "春季至秋季",
        "分佈": "外來種：原生於美洲；分佈於台灣全島各地。",
        "毒性警告": "安全無毒。",
        "食用安全性": "莖葉幼嫩的部分可以食用，趁其未開花前摘取，洗乾淨之後便可炒食或煮湯。",
        "藥用價值": "抗氧化、抗微生物、抗腫瘤、止瀉、抗發炎、利尿、肝臟保護、降血壓，以及抗糖尿病。",
        "環保資訊": "根系穩定土壤、防止水土流失，並形成地面覆蓋以減少水分蒸發；花朵吸引授粉昆蟲，促進生物多樣性。植物透過光合作用改善空氣質量，但其主要環境價值在於保護土壤並支持生態系統。",
    },
    "Chloris_barbata": {
        "中文名稱": "孟仁草(別名：紅拂草)",
        "屬性": "禾本科虎尾草屬",
        "花的顏色": "紫紅色",
        "花語": "無",
        "生長季節": "花期夏季至秋季",
        "分佈": "外來種：原生於中南美洲；分佈於臺灣全島向陽沙地、荒地、路邊。",
        "毒性警告": "含有危險毒素。",
        "食用安全性": "不可食用。",
        "藥用價值": "祛風止痛、清熱解毒、活血化瘀。",
        "環保資訊": "強大的根系網絡能幫助土壤緊密結合，大幅減少侵蝕的可能性。它將基本養分重新釋放回土壤中，增強土壤的肥力，這種改良在農業環境中特別有價值。",
    },
    "Marsilea_quadrifolia": {
        "中文名稱": "四葉草(別名：田字草)",
        "屬性": "蘋科蘋屬",
        "花的顏色": "無開花",
        "花語": "無",
        "生長季節": "春季到秋季",
        "分佈": "外來種：原生於東南亞地區；分佈於台灣水田或濕泥之上。",
        "毒性警告": "安全無毒。",
        "食用安全性": "全草可食用。",
        "藥用價值": "全草：利尿劑，解毒，止血劑，安神，截瘧。汁液塗布，治腫瘍。",
        "環保資訊": "根系幫助穩定水域土壤，防止水土流失，並吸收過多的養分，改善水質。葉片提供水面遮蔽，減少水分蒸發，還能促進水域生物多樣性，維持健康的水生生態系統。",
    },
    "Alocasia_odora": {
        "中文名稱": "姑婆芋(別名：海芋)",
        "屬性": "天南星科海芋屬",
        "花的顏色": "白色",
        "花語": "家庭和睦",
        "生長季節": "春季至夏季",
        "分佈": "本土種；分佈於台灣中低山區。",
        "毒性警告": "姑婆芋植物細胞中含有針狀針晶，誤食會中毒。",
        "食用安全性": "不可食用。",
        "藥用價值": "根莖搗爛，可外敷腫毒。",
        "環保資訊": "可以提高室內的濕度水平，也能有效過濾空氣中的常見家庭毒素和污染物，如甲醛、苯和三氯乙烯，有助於創造更健康的生活空間。",
    },
    "Murraya paniculata": {
        "中文名稱": "月橘(別名：七里香)",
        "屬性": "芸香科九里香屬",
        "花的顏色": "白色",
        "花語": "甘願為心愛的人付出一切",
        "生長季節": "花期春季至夏季，果期秋季至初冬",
        "分佈": "外來種：原生於亞洲南部；分佈於台灣全境平地山麓或路旁。",
        "毒性警告": "含有危險毒素。",
        "食用安全性": "果實成熟可食用。",
        "藥用價值": "以葉和帶葉嫩枝入藥，祛風除濕、行氣活血、散瘀止痛、解毒。",
        "環保資訊": "通過光合作用改善空氣質量，吸引授粉昆蟲，促進生物多樣性。其根系有助於固定土壤，減少水土流失，並提供陰涼，幫助降溫，減少熱島效應。作為觀賞植物，它也能美化環境，提升綠化水平。",
    },
    "Lantana camara": {
        "中文名稱": "馬纓丹(別名：五色梅)",
        "屬性": "馬纓丹屬",
        "花的顏色": "橙色、紅色、黃色、白色、紫色、粉紅色",
        "花語": "喜歡冒險，英雄主義者",
        "生長季節": "花期四季",
        "分佈": "外來種：原生於南美洲、西印度；分佈於台灣平地野外。",
        "毒性警告": "莖葉與果實中含有破壞代謝的毒性。",
        "食用安全性": "不可食用。",
        "藥用價值": "馬纓丹葉搗爛後取其汁液敷於患部亦有消腫與解熱的功效。",
        "環保資訊": "能自然驅避害蟲，馬纓丹散發出一種對許多常見害蟲如蚊子和蚜蟲來說不愉快的特殊香氣。延長開花期為授粉者提供穩定的食物來源，進一步支持繁榮的生態系統。",
    },
    "Ixora chinensis": {
        "中文名稱": "仙丹花(別名：紅繡球)",
        "屬性": "仙丹花屬",
        "花的顏色": "白色、红色、黄色、粉紅色、橘色",
        "花語": "團結",
        "生長季節": "花期春季、夏季",
        "分佈": "外來種：原生於中國南方與馬來西亞；台灣全島普遍栽種。",
        "毒性警告": "枝葉，誤觸其白色乳汁可能引起紅腫和發炎反應。",
        "食用安全性": "花可食用。",
        "藥用價值": "根有降壓活血，行氣止痛之效；花可治月經不調，高血壓；根可治肺結核咳嗽；莖葉可治跌打損傷。",
        "環保資訊": "花朵能吸引授粉昆蟲，促進生物多樣性。它通過光合作用改善空氣質量，並提供陰涼，幫助降低周圍溫度，對緩解熱島效應有一定作用，是一種有助於環境改善和綠化的植物。",
    },
    "Eragrostis tenella": {
        "中文名稱": "鯽魚草(別名：亂草)",
        "屬性": "禾本科畫眉草屬",
        "花的顏色": "白色、綠色",
        "生長季節": "花果期春季、夏季",
        "分佈": "外來種：原生於南亞和東南亞；分佈於台灣全島產在郊野路邊、耕地或山坡。",
        "毒性警告": "安全無毒。",
        "食用安全性": "種子可食用。",
        "藥用價值": "清熱涼血，治咳血，吐血。",
        "環保資訊": "密集根系在穩定土壤和防止侵蝕方面發揮著重要作用。吸收土壤中的養分，並通過葉片凋落和根部腐爛返回有機物質，豐富了土壤，促進了其他植物更健康、更肥沃的生長環境。",
    },
    "Duranta erecta": {
        "中文名稱": "金露花(別名：如意草)",
        "屬性": "馬鞭草科金露花屬",
        "花的顏色": "淡藍色、淺紫色、深紫色、白色",
        "花語": "尊敬和祝福",
        "生長季節": "花期春季、夏季",
        "分佈": "外來種：原生於中美洲；台灣本島普遍栽培為綠籬。",
        "毒性警告": "果實和葉子有毒，一旦食用會引起嚴重的嘔吐、腹瀉和腹痛。",
        "食用安全性": "不可食用。",
        "藥用價值": "莖葉治瘧疾、止癢、祛瘀消腫、治跌打胸痛損傷。果實治療瘧疾，花為興奮劑。",
        "環保資訊": "金露花能吸引捕食性天敵，如瓢蟲和草蛉等，從而增強田區控制小型害蟲的效果。",
    },
    "Cordyline fruticosa": {
       "中文名稱": "朱蕉(別名:紅葉鐵樹)",
       "屬性": "天門冬科朱蕉屬",
       "花的顏色": "白色、粉紅色",
       "花語": "勇氣和堅韌",
       "生長季節": "晚春、夏天、秋天",
       "分佈": "外來種：原產於中國華南、喜馬拉雅山、印度、馬來西亞、澳洲及太平洋群島等熱帶地區。台灣於 1865 年由廣東引進種植。",
       "毒性警告": "安全無毒。",
       "食用安全性": "果實可以食用。",
       "藥用價值": "清熱止血、散瘀。",
       "環保資訊": "朱蕉以其空氣淨化特性而聞名，有助於改善室內環境的健康。",
    },
    "Psidium guajava": {
       "中文名稱": "番石榴(別名:芭樂)",
       "屬性": "桃金孃科番石榴屬",
       "花的顏色": "白色",
       "花語": "無瑕的愛",
       "生長季節": "花期四季；盛花期春季至初夏。",
       "分佈": "外來種：原產於墨西哥、中美洲至南美洲；臺灣分布於平地。", 
       "毒性警告": "安全無毒。",
       "食用安全性": "果實可以食用。",
       "藥用價值": "果及葉:止瀉痢、治糖尿，但大便秘結及積滯未清者忌服；葉:治外傷及跌打；根:僧侶之制慾劑。",
       "環保資訊": "堆肥(生)廚餘。",
    },
    "Pilea cadierei": {
       "中文名稱": "花葉冷水花(別名:金邊山羊血)",
       "屬性": "蕁麻科冷水麻屬",
       "花的顏色": "綠白色",
       "花語": "友誼、忠誠",
       "生長季節": "花期為秋季，果期為初冬。",
       "分佈": "外來種:原產於東南亞；生長於海拔300米至1,500米的地區，常生於山谷或溪旁林下陰暗潮濕處。", 
       "毒性警告": "植物中含有生物鹼，對人類和寵物都有毒。",
       "食用安全性": "不能過量。",
       "藥用價值": "雖有很好的保健作用，但是過量會導致腸胃不適，甚至中毒。有很好的活血化瘀作用。注意事項：孕婦、月經量大、服用抗凝血藥者忌用。",
       "環保資訊": "冷水花吸收二氧化碳的能力比一般花卉高很多，還能消除室內裝修汙染和傢俱油漆散發出的有害氣體，能有效吸收一般粉塵和油煙，是一種集吸滯、解毒、滅菌能力於一身的天然空氣清新劑。",
    },
    "Wisteriopsis reticulata": {
       "中文名稱": "網絡夏藤(別名:老荊藤)",
       "屬性": "豆科崖豆藤屬",
       "花的顏色": "紫色",
       "花語": "勇氣與堅韌",
       "生長季節": "春季至秋季",
       "分佈": "本土種:台灣中部低海拔山區林緣及溪旁。", 
       "毒性警告": "有小毒。",
       "食用安全性": "莖部汁液入水煮，加上紅花、當歸、糯米熬膏 。",
       "藥用價值": "莖:可入藥，俗稱昆明雞血藤；藤：治腰酸痛麻木、月經不調、跌打損傷；根：鎮靜、治躁狂型精神分裂症。",
       "環保資訊": "能耐受乾旱，成為繁忙園丁或希望節水的理想選擇。強健的根系有助於穩定土壤，防止坡道和堤岸的侵蝕。",
    },
    "Schefflera arboricola": {
        "中文名稱": "鵝掌蘗(別名：鴨腳木)",
        "屬性": "鵝掌蘗屬",
        "花的顏色": "淡黃色、白色",
        "花語": "幸福和繁榮",
        "生長季節": "夏天、秋天",
        "分佈": "外來種：原生於中國南部的熱帶及亞熱帶地區，台灣的分佈在東部跟南部潮濕地區。",
        "毒性警告": "毒性低，葉子不可以讓小孩和寵物吃到會導致口腔喉嚨疼痛嚴重的話會導致嘔吐。",
        "食用安全性": "不可食用。",
        "藥用價值": "祛風除濕、活血、止痛、壯筋骨、消腫之效。",
        "環保資訊": "能改善空氣質量，還能在節水和低維護的情況下提供室內植物美觀的裝飾。",
    },
    " pleroma granulosum": {
        "中文名稱": "方莖野牡丹(別名：角莖野牡丹)",
        "屬性": "野牡丹屬",
        "花的顏色": "紫紅色、粉紅色、白色、淡紫色",
        "花語": "象徵活力、熱情",
        "生長季節": "全年",
        "分佈": "外來種：原生於東南亞、南亞及澳洲，台灣的分佈在沿海地區和低海拔山區。",
        "毒性警告": "無毒。",
        "食用安全性": "可食用。",
        "藥用價值": "果實和葉片被用作草藥，具有一定的抗菌、抗氧化和抗炎作用。",
        "環保資訊": "在防止沙丘侵蝕方面，能夠穩固土壤並提供庇護所給許多小動物。",
    },
    " Lantana camara ": {
        "中文名稱": "馬纓丹(別名：五色梅)",
        "屬性": "馬纓丹屬",
        "花的顏色": "紅色、橙色、粉紅色",
        "花語": "友誼和快樂",
        "生長季節": "夏天秋天",
        "分佈": "外來種：原生於南亞和東南亞，台灣的分佈在沿海地區、低海拔地區跟城市園藝栽培，南部東部最為常見。",
        "毒性警告": "無毒。",
        "食用安全性": "可食用。",
        "藥用價值": "葉子用來治療皮膚病跟發炎，根本用來治療發燒跟解毒。",
        "環保資訊": "美化環境，有助於改善空氣質量、減少城市熱島效應、維護生物多樣性及土壤穩定。",
    },
    " Ixora coccinea": {
        "中文名稱": "紅仙丹花(別名：山丹花)",
        "屬性": "馬纓丹屬",
        "花的顏色": "紅色",
        "花語": "熱情和愛",
        "生長季節": "春天夏天",
        "分佈": "外來種：原生於印度、斯里蘭卡、馬來西亞，台灣分佈在中部以南熱帶區域。",
        "毒性警告": "無毒。",
        "食用安全性": "可食用。",
        "藥用價值": "根部用來治療發燒咳嗽，被認為有一定的解毒和降溫作用，葉子用來治療皮膚病或發炎。",
        "環保資訊": "美化和綠化環境外，它還能改善空氣質量、減少熱島效應、支持生物多樣性、保護水土、節水和減少污染。",
    },
    " Alpinia zerumbet": {
        "中文名稱": "月桃(別名：玉桃)",
        "屬性": "月桃屬",
        "花的顏色": "白色、淡粉色",
        "花語": "純潔和高雅",
        "生長季節": "花期春季、夏季、秋季",
        "分佈": "外來種：原生於東南亞和太平洋地區，台灣分佈廣泛主要集中在南部和東部低海拔區域。",
        "毒性警告": "無毒。",
        "食用安全性": "可食用。",
        "藥用價值": "根部用來治療消化不良以及關節炎等炎症疾病，葉子用來治療咳嗽以及上呼吸道感染還有外敷治療可以緩解肌肉疼痛或傷口癒合。",
        "環保資訊": "能夠改善空氣質量、減少城市熱島效應、保護水土、促進生物多樣性，並且適應性強，對水資源的需求較少。",
    },
    " Sphagneticola trilobata": {
        "中文名稱": "南美蟛蜞菊(別名：黃花蜜菜)",
        "屬性": "蟛蜞菊屬",
        "花的顏色": "黃色",
        "花語": "友誼和快樂",
        "生長季節": "花期春季、夏季、秋季",
        "分佈": "外來種：原生於南美，台灣分佈主要集中在低海拔的農田、濕地、草地和水邊。", 
        "毒性警告": "無毒。",
        "食用安全性": "可食用。",
        "藥用價值": "外用：用於治療皮膚病、傷口癒合、濕疹等，也常用來製作頭髮護理產品。內服：用於治療肝臟病、消化不良、黃疸等症狀。",
        "環保資訊": "強大的根系有助於水土保持、減少土壤侵蝕；它能夠支持生物多樣性，吸引昆蟲，對維護生態平衡起到積極作用。",
    },
    "Tridax procumbens": {
        "中文名稱": "長柄菊(別名:灣比斯坎匍匐牛眼草)",
        "屬性": "菊科",
        "花的顏色": "白色",
        "花語": "沒有花語",
        "生長季節": "全年開花，特別在夏季旺盛",
        "分佈": "它原產於墨西哥、中美洲和加勒比地區，但現在遍布新熱帶地區。",
        "毒性警告": "無",
        "食用安全性": "不可食用。",
        "藥用價值": "具藥用價值，用於消炎、止血。",
        "環保資訊": "水土保持，抗污染植物，低維護需求。",
    },
    "Ipomoea triloba": {
        "中文名稱": "銳葉牽牛(別名:小花假番薯)",
        "屬性": "旋花科",
        "花的顏色": "通常的花色是粉紫色或淡紫色，有時也會呈現淡粉紅色或白色。",
        "花語": "愛情,努力與堅持",
        "生長季節": "生長季節：夏秋季開花",
        "分佈": "分布在台灣島、美洲熱帶以及中國大陸的廣東等地，多生在丘際陵路旁、荒草地及田野，目前尚未由人工引種栽培。", #加句號
        "毒性警告": "牽牛屬植物的種子通常具有毒性。",
        "食用安全性": "不可食用。",
        "藥用價值": "無。",
        "環保資訊": "防止土壤侵蝕。",
    },
    "Plumeria obtusa": {
       "中文名稱": "緬梔花 (別名:紅雞蛋花)",
       "屬性": "夾竹桃科緬梔屬",
       "花的顏色": "白色, 黃色,粉紅色,紅色,混色",
       "花語": "純潔與高貴,不朽的愛情與回憶,再生與新生,歡樂與祝福",
       "生長季節": "春夏開花",
       "分佈": "分布在南美洲、墨西哥、亞熱帶、熱帶亞洲以及中國大陸的廣東、廣西、雲南、福建等地，目前已由人工引種栽培。",
       "毒性警告": "樹皮及乳汁有毒",
       "食用安全性": "不可食用。",
       "藥用價值": "具藥用價值，可用於消炎、抗菌。",
       "環保資訊": "空氣淨化、水土保持、耐旱和低維護需求。",
    },
    "Lagerstroemia specios": {
       "中文名稱": "大花紫薇 (別名:洋紫薇)",
       "屬性": "桃金孃目千屈菜科",
       "花的顏色": "呈紫色或淡紫紅色，有時會呈現粉紅色或白色",
       "花語": "愛的守護與堅韌",
       "生長季節": "夏季開花",
       "分佈": "大花紫薇原產於印度、中國及澳洲。現在主要分布在印度、斯里蘭卡、澳洲、馬來西亞、越南、菲律賓及中國的廣東、廣西、福建、香港。",
       "毒性警告": "無。",
       "食用安全性": "可食用。",
       "藥用價值": "具藥用，可用於降血糖、抗菌。",
       "環保資訊": "城市綠化與美化，空氣淨化，水土保持，低維護需求。",
    },
    "Ruellia simplex": {
       "中文名稱": "紫花蘆莉草  (別名:紫蝴蝶花)",
       "屬性": "爵床科盧利草屬    ",
       "花的顏色": "紫色",
       "花語": "堅韌與活力,靜謐與祥和",
       "生長季節": "全年開花",
       "分佈": "原產於墨西哥。是台灣地區相當普及的園藝植物，街道邊與公園裡常見，田野間也可見到野生歸化的翠蘆莉。",
       "毒性警告": "無。",
       "食用安全性": "不可食用。",
       "藥用價值": "少量藥用價值，用於利尿。",
       "環保資訊": "城市綠化與美化，水土保持，低維護需求，促進生物多樣性，抗污染植物。",
    },
    "Alternanthera dentata": {
        "中文名稱": "紅龍草(別名:紫絹)",
        "屬性": "莧科蓮子草屬",
        "花的顏色": "乳白色",
        "花語": "無花語",
        "生長季節": "花期秋季，果期冬季",
        "分佈": "外來種:原產於西印度群島、巴西地；台灣各地均有種植。",
        "毒性警告": "安全無毒。",
        "食用安全性": "花不可食用。",
        "藥用價值": "無法藥用。",
        "環保資訊": "無法環保。",
    },
    "Cascabela thevetia": {
        "中文名稱": "黃花夾竹桃(別名:酒杯花)",
        "屬性": "夾竹桃科黃花夾竹桃屬",
        "花的顏色": "黃色",
        "花語": "友誼和幸福",
        "生長季節": "春天、 秋天",
        "分佈": "外來種:原產於南美洲、中美洲及印度；台灣各地均有種植。", 
        "毒性警告": "全株所含白色乳汁有劇毒。",
        "食用安全性": "不可食用。",
        "藥用價值": "樹皮為催吐劑及瀉劑。",
        "環保資訊": "抗汙能力很強 ，能淨化空氣。",
    },
    "Rhaphiolepis bibas": {
        "中文名稱": "枇杷(別名:夏果)",
        "屬性": "薔薇科枇杷屬",
        "花的顏色": "白色、淡黃色",
        "花語": "愛和溫暖",
        "生長季節": "花期秋、冬季，果期春季",
        "分佈": "外來種:原產於中國四川省及江南，於明末移民時引進；台灣分布於山區與平地。", 
        "毒性警告": "安全無毒。",
        "食用安全性": "果實可以食用。",
        "藥用價值": "果：潤氣下肺，止咳；葉：清肺化痰，降逆止嘔，止渴；花：治寒咳；種子、根：化肺止咳，利水消腫，舒肝行氣。",
        "環保資訊": "無法環保。",
    },
    "Garcinia subelliptica": {
        "中文名稱": "菲島福木(別名:楠仔)",
        "屬性": "藤黃科福木屬",
        "花的顏色": "黃白色",
        "花語": "無花語",
        "生長季節": "春季、秋季",
        "分佈": "本土種:日本琉球群島、菲律賓、印尼、斯里蘭卡、台灣；台灣全島各地普遍栽培。", 
        "毒性警告": "本身乳汁有毒。",
        "食用安全性": "不可食用。",
        "藥用價值": "根治腸炎、痢疾。",
        "環保資訊": "含抗氧化劑。七號福木酵素能抑制校園雜草土香的生長，也能有效防治菜園，內含果皮和果肉的酵素，稀釋後最適合當植物的液肥；福木酵素能驅趕蚊子、扁蝸牛和紋白蝶幼蟲。",
    },
    "Hedychium coronarium": {
        "中文名稱": "野薑花(別名:蝴蝶花)",
        "屬性": "薑科蝴蝶薑屬",
        "花的顏色": "純白色、黃色、金黃色、粉紅色、橘黃色、粉紅色",
        "花語": "信賴、高潔、清雅",
        "生長季節": "夏、秋季",
        "分佈": "外來種:原產於印度喜馬拉雅山；台灣分布於高溫潮濕的環境。", 
        "毒性警告": "安全無毒。",
        "食用安全性": "嫩芽、花、地下莖皆可食用。",
        "藥用價值": "根莖：消腫止痛、止咳嗽。",
        "環保資訊": "無法環保。",
    },
    "Heptapleurum arboricola": {
        "中文名稱": "鵝掌藤(別名:七葉蓮)",
        "屬性": "五加科鵝掌柴屬",
        "花的顏色": "綠色",
        "花語": "無花語",
        "生長季節": "秋季",
        "分佈": "外來種:原產於東南亞、大洋洲；台灣分布於平地山野至海拔1,800公尺之岩壁及樹上。", 
        "毒性警告": "攝入或接觸會導致狗、貓及兒童的毒性反應。",
        "食用安全性": "不可食用。",
        "藥用價值": "行氣止痛、活血消腫、辛香走竄、溫通血脈。",
        "環保資訊": "鵝掌藤是優質的綠化樹種，耐熱耐旱且能抗空氣污染，能適應都市氣候環境，種植於道路邊作為綠籬或高架橋下綠化用。",
    },
    "Hibiscus rosa-sinensis": {
        "中文名稱": "朱槿(別名:佛桑)",
        "屬性": "錦葵科木槿屬",
        "花的顏色": "黃色、粉紅色、淡粉色、白色、桃紅色、紅色",
        "花語": "體貼之美、纖細美、永保清新之美",
        "生長季節": "全年開花",
        "分佈": "外來種:原產於華南、印度、東非；台灣分布於平地至海拔500公尺以下地區。", 
        "毒性警告": "安全無毒。",
        "食用安全性": "花川燙後加冰水、糖可製成冰品、果凍或沙拉。",
        "藥用價值": "解毒、調經、通便、消炎、消腫、止血。",
        "環保資訊": "可以吸收紫外線。",
    },
    "Hibiscus tiliaceus": {
        "中文名稱": "黃槿(別名:朴仔)",
        "屬性": "錦葵科木槿屬",
        "花的顏色": "黃色、橘色",
        "花語": "平靜與祥和",
        "生長季節": "花期夏、秋季，果期秋、冬季",
        "分佈": "外來種:原產於東亞溫帶地區；台灣分布於平野及濱海地區。", 
        "毒性警告": "安全無毒。",
        "食用安全性": "花冠可和蛋汁一起油炸，鮮美可口。",
        "藥用價值": "葉及樹皮:治支氣管炎及咳嗽；葉:外敷治腫毒；根:解熱、催吐劑；全株:清熱解毒、散瘀消腫。",
        "環保資訊": "有抗鹽抗旱的特性，防止土壤侵蝕，可作為熱帶海岸地區防風、防沙、防潮的優良樹種。",
    },
    "Humulus japonicus": {
        "中文名稱": "葎草(別名:日本啤酒花)",
        "屬性": "大麻科葎草屬",
        "花的顏色": "無花",
        "花語": "無花語",
        "生長季節": "全年",
        "分佈": "本土種:中國大陸、日本、越南及台灣；台灣分布於各地平野及低山帶。", 
        "毒性警告": "安全無毒。",
        "食用安全性": "嫩葉和嫩芽可以煮來食。",
        "藥用價值": "清熱解毒、利尿通淋。",
        "環保資訊": "染料不含有化學物質，對環境友好，不會對水和土壤造成汙染。在商業化動物飼料尚未廣泛利用的農村時代，葎草的嫩莖嫩葉是牲畜飼料的選項之一。",
    },
    "Hydrangea chinensis": {
        "中文名稱": "中國繡球(別名:華八仙)",
        "屬性": "繡球花科繡球屬",
        "花的顏色": "藍色、紫色、白色、粉紅色",
        "花語": "感謝、希望、忠貞、永恆、美滿及團聚",
        "生長季節": "花期夏季，果期秋季",
        "分佈": "本土種:中國南部、琉球及台灣；台灣2400公尺以下低海拔闊葉林下皆有分布。", 
        "毒性警告": "整棵植物有毒，但氣味無毒，只要不湊近聞，碰到後洗手，一般對人體不會有傷害。",
        "食用安全性": "不可食用。",
        "藥用價值": "全株：治肺癆；根：利尿、抗瘧、袪瘀止痛、活血生辛。",
        "環保資訊": "防止土壤侵蝕，落葉會隨時間分解，為土壤提供有機物質。這一自然過程改善了土壤肥力，惠及花園中的其他植物。",
    },
    "Gardenia jasminoides": {
        "中文名稱": "梔子(別名:玉堂春)",
        "屬性": "茜草科黃梔子屬",
        "花的顏色": "黃色、白色",
        "花語": "一生的守候、永恆的愛和喜悅",
        "生長季節": "春季、夏季",
        "分佈": "外來種:原產於中國；台灣分布於低中海拔山區。", 
        "毒性警告": "對人類無毒，但可能引起過敏反應。",
        "食用安全性": "花曬乾可供花茶香料。",
        "藥用價值": "瀉火除煩、清熱利濕、涼血解毒。",
        "環保資訊": "無法環保。",
    },
    "Hibiscus taiwanensis": {
        "中文名稱": "山芙蓉(別名:台灣芙蓉)",
        "屬性": "錦葵科木槿屬",
        "花的顏色": "白色、粉色、紅色",
        "花語": "勇氣、堅強和不屈不撓",
        "生長季節": "花期夏、秋季，果期冬季",
        "分佈": "本土種:台灣分布於中低海拔山區。", 
        "毒性警告": "安全無毒。",
        "食用安全性": "花朵幾乎都可食用。",
        "藥用價值": "消炎、解毒、清肺、涼血。",
        "環保資訊": "無法環保。",
    },
    "Ipomoea cairica": {
        "中文名稱": "槭葉牽牛(別名:番仔藤)",
        "屬性": "璇花科牽牛花屬",
        "花的顏色": "紫紅色",
        "花語": "短暫的愛情",
        "生長季節": "全年，盛開期夏、秋季",
        "分佈": "外來種:原產於北非洲；台灣平地至山麓皆有種植。", 
        "毒性警告": "全草有毒。",
        "食用安全性": "不可食用。",
        "藥用價值": "莖：清熱解毒、利水通淋、止咳、止血、尿血、淋症、水腫；果實：治跌打損傷。",
        "環保資訊": "無法環保。",
    },
    "Ipomoea obscura": {
        "中文名稱": "小心葉薯(別名:紫心牽牛)",
        "屬性": "旋花科番薯屬",
        "花的顏色": "淡黃色",
        "花語": "無花語",
        "生長季節": "秋、冬季",
        "分佈": "本土種:台灣、熱帶亞洲、澳洲、非洲；台灣全島低海拔山野及荒地皆有分布。", 
        "毒性警告": "全草有小毒，種子毒性較大。",
        "食用安全性": "不可食用。",
        "藥用價值": "種子:治療逐水、利小便。",
        "環保資訊": "無法環保。",
    },
    "Ixeris chinensis": {
        "中文名稱": "中華小苦蕒(別名:兔仔菜)",
        "屬性": "菊科兔仔菜屬",
        "花的顏色": "深黃色",
        "花語": "無花語",
        "生長季節": "全年",
        "分佈": "本土種:南亞洲至東亞洲臺灣地區；台灣分布於平地及低海拔至高海拔山區。", 
        "毒性警告": "安全無毒。",
        "食用安全性": "嫩葉可作野菜食用。",
        "藥用價值": "瀉火、涼血、止血、止痛、調經、活血、袪腐生肌、治無名腫毒、陰囊濕疹、衄血、跌打損傷、肺炎、肺癰、腸炎、痢疾、瘡癤痛腫等症。",
        "環保資訊": "無法環保。",
    },
    "Tulipa gesneriana": {
        "中文名稱": "鬱金香(別名:草麝香)",
        "屬性": "百合科鬱金香屬",
        "花的顏色": "粉紅、紅、紫、黃白和橙色",
        "花語": "愛、慈善、勝利、美麗、幸福、永恆、愛的表白、永恆的祝福",
        "生長季節": "春季",
        "分佈": "外來種:歐洲南部至小亞細亞、土耳其；台灣全島各地普遍栽培。", 
        "毒性警告": "安全無毒。",
        "食用安全性": "不可食用。",
        "藥用價值": "不可藥用。",
        "環保資訊": "無法環保。",
    },
}

st.set_page_config(page_title="花草辨識小助理", page_icon="🌱", layout="wide")

st.title("🌿 花草辨識小助理")
st.write("探索校園的植物世界，學習植物知識，感受自然之美！")

language = st.sidebar.selectbox("🌐 選擇語言", ("中文", "English"))
if language == "English":
    st.title("🌿 Plant Identification Application")
    st.write("Explore the plants around you, learn about their characteristics, and connect with nature!")
    upload_label = "Upload Image"
    take_photo_label = "Take Photo"
    result_label = "Recognition Results"
    history_label = "History"
    eco_info = "Environmental Benefits of Plants"
    eco_details = """
    Plants play a vital role in reducing global warming by providing oxygen and absorbing carbon dioxide, contributing to ecological balance.
    """
else:
    upload_label = "上傳圖片"
    take_photo_label = "拍照"
    result_label = "辨識結果"
    history_label = "歷史記錄"
    eco_info = "環保資訊"
    eco_details = """
    植物在減緩全球暖化中扮演重要角色，能提供氧氣並吸收二氧化碳，對維持生態平衡貢獻巨大。
    """


st.sidebar.header("功能選項")
option = st.sidebar.radio("選擇來源", (take_photo_label, upload_label))


if "history" not in st.session_state:
    st.session_state["history"] = []

image = None


if option == take_photo_label:
    st.subheader("📸 使用相機拍攝")
    camera_photo = st.camera_input("點擊下方按鈕拍照")
    if camera_photo is not None:
        image = Image.open(camera_photo)
        st.image(image, caption="拍攝的圖片", width=300)

elif option == upload_label:
    st.subheader("📤 上傳圖片")
    uploaded_file = st.file_uploader("選擇圖片", type=["jpg", "jpeg", "png"])
    if uploaded_file is not None:
        image = Image.open(uploaded_file)
        st.image(image, caption="上傳的圖片", width=300)


st.subheader(result_label)
if image is not None:
    image_np = np.array(image)
    results = model(image_np)
    predictions = results[0].boxes.data.cpu().numpy()

    if len(predictions) > 0:
        # 將辨識結果按信心分數排序，取準確率最高的一種
        best_prediction = max(predictions, key=lambda row: row[4])  # 假設信心分數在第五欄
        plant_name= model.names[int(best_prediction[5])]  # 假設類別標籤在第六欄
        confidence = best_prediction[4]

        # 顯示最高準確率的植物資訊
        st.markdown(f"**植物學名：{plant_name}** (信心分數：{confidence:.2f})")

        if plant_name in plant_info:
            info = plant_info[plant_name]
            # 🌿 標題
            st.subheader(f"🌸 {info['中文名稱']}")

            # 🌱 **基本資訊**
            with st.expander("### 📌 基本資訊"):
                st.write(f"🌿 **屬性**：{info['屬性']}")
                st.write(f"🎨 **花的顏色**：{info['花的顏色']}")
                st.write(f"💐 **花語**：{info['花語']}")

            # 🌍 **生長與分佈**
            with st.expander("### 🌱 生長與分佈"):
                st.write(f"📆 **生長季節**：{info['生長季節']}")
                st.write(f"📍 **分佈**：{info['分佈']}")

            # ⚠️ **安全性**
            with st.expander("### ⚠️ 安全性"):
                st.write(f"⚠️ **毒性警告**：{info['毒性警告']}")
                st.write(f"🍴 **食用安全性**：{info['食用安全性']}")

            # 💊 **應用價值**
            with st.expander("### 🌿 應用價值"):
                st.write(f"💊 **藥用價值**：{info['藥用價值']}")
                st.write(f"🌍 **環保資訊**：{info['環保資訊']}")
    
        # 保存結果到歷史記錄
        st.session_state["history"].append((image, [(plant_name, confidence)]))
    else:
        st.write("未能辨識出植物")
else:
    st.write("請先上傳或拍攝圖片")
    
st.sidebar.subheader(history_label)
if len(st.session_state["history"]) > 0:
    for idx, (img, plants) in enumerate(st.session_state["history"]):
        # 取得第一個辨識出的植物名稱，若無則顯示 "未知植物"
        plant_name = plants[0][0] if plants else "未知植物"

        with st.sidebar.expander(f"🌿 {plant_name}"):
            st.image(img, caption="辨識圖片", use_container_width =True)
            for plant, conf in plants:
                st.write(f"- **{plant}** (信心分數：{conf:.2f})")
else:
    st.sidebar.write("目前尚無辨識記錄")

st.markdown("---")
st.markdown("✨ **探索自然，從身邊的植物開始！**")
